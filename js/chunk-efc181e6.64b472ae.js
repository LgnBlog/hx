(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-efc181e6"],{"5d8d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"result-preview-dialog"},[this.visible?a("el-dialog",{staticClass:"dialog",attrs:{title:"提示",visible:this.visible,width:"70%","before-close":e.handleClose,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(this,"visible",t)}}},[a("span",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[a("el-row",{staticStyle:{display:"flex","align-items":"center"}},[a("el-col",{attrs:{span:4}},[a("span",{staticClass:"header-text"},[e._v(e._s(e.isPreview?"推荐结果预览":"推荐关联关系"))])]),"histroy"===e.type?a("el-col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:9}},[a("span",{staticStyle:{width:"100px"}},[e._v("更新时间：")]),a("el-date-picker",{attrs:{type:"date",size:"mini","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1):e._e()],1)],1),a("div",{staticClass:"dialog-content"},[e.isPreview?e._e():a("div",{staticClass:"dialog-content-top"},[a("div",{staticClass:"dialog-table"},[e.labelRelationRes?a("el-table",{staticClass:"dialog-table",staticStyle:{width:"100%",height:"100%"},attrs:{data:e.labelRelationData,height:"187px",border:"","header-cell-style":e.headStyle}},[a("el-table-column",{attrs:{type:"index",label:"关联序号",width:"100px"}}),a("el-table-column",{attrs:{prop:"tagTargetName",label:"目标对象名称"}}),a("el-table-column",{attrs:{prop:"tagRecName",label:"推荐对象名称"}}),a("el-table-column",{attrs:{prop:"weight",label:"权重",width:"200"}})],1):a("div",{staticClass:"no-data"},[a("span",[e._v("暂无数据")])])],1),a("el-pagination",{staticClass:"dialog-pagination",attrs:{"current-page":e.labelForm.current,"page-sizes":[10,20,30,40],"page-size":e.labelForm.size,layout:" prev, pager, next, sizes,jumper,total",total:e.labelForm.total},on:{"size-change":e.labelSizeChange,"current-change":e.labelCurrentChange}})],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-content-bottom"},[e.isPreview?e._e():a("div",{staticClass:"dialog-title"},[a("span",{staticClass:"text"},[e._v("推荐结果预览")])]),a("div",{staticClass:"dialog-search"},[a("el-form",{staticClass:"dialog-form",attrs:{model:e.resultForm,"label-width":"160px"}},[a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"目标对象显示字段：",prop:"targetSubjectField"}},[a("el-select",{staticClass:"input",attrs:{size:"mini",multiple:"",placeholder:"请选择","collapse-tags":""},model:{value:e.resultForm.targetSubjectField,callback:function(t){e.$set(e.resultForm,"targetSubjectField",t)},expression:"resultForm.targetSubjectField"}},e._l(e.targetSubjectFieldOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"推荐对象显示字段：",prop:"recommendedSubjectField"}},[a("el-select",{staticClass:"input",attrs:{size:"mini",multiple:"",placeholder:"请选择","collapse-tags":""},model:{value:e.resultForm.recommendedSubjectField,callback:function(t){e.$set(e.resultForm,"recommendedSubjectField",t)},expression:"resultForm.recommendedSubjectField"}},e._l(e.recommendedSubjectFieldOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:this.filterField(this.resultForm.targetKeyName)+"：",prop:"targetSearchText"}},[a("el-input",{staticClass:"input",attrs:{size:"mini",placeholder:"请输入"},model:{value:e.resultForm.targetSearchText,callback:function(t){e.$set(e.resultForm,"targetSearchText",t)},expression:"resultForm.targetSearchText"}})],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:this.filterField(this.resultForm.recKeyName)+"：",prop:"recommendSearchText"}},[a("el-input",{staticClass:"input",attrs:{size:"mini",placeholder:"请输入"},model:{value:e.resultForm.recommendSearchText,callback:function(t){e.$set(e.resultForm,"recommendSearchText",t)},expression:"resultForm.recommendSearchText"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.searchResultPreviewData}},[e._v("搜索")])],1)],1)],1)],1)],1),a("div",{staticClass:"dialog-table",style:{height:e.isPreview?"345px":"187px"}},[e.resultPreviewRes?a("el-table",{attrs:{data:e.resultPreviewData,border:"",height:e.isPreview?"342px":"187px","header-cell-style":e.headStyle,"cell-style":e.timeStyle},on:{"selection-change":e.handleSelectionChange}},[e.isSelect&&0!==e.resultPreviewData.length?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._l(e.columnData,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t.prop,label:t.label,width:t.width,align:t.align?t.align:"left"},scopedSlots:e._u([{key:"default",fn:function(r){return["Operate"===t.prop?a("div",{staticClass:"operate"},e._l(t.type,(function(t,l){return a("el-button",{key:l,attrs:{type:"text"},on:{click:function(a){return e.operate(t.action,r.row)}}},[e._v(e._s(t.name))])})),1):a("div",{staticClass:"text"},[a("span",[e._v(e._s(r.row[t.prop]))])])]}}],null,!0)},[e._v("\n              >\n              ")])}))],2):e._e()],1),a("el-pagination",{staticClass:"dialog-pagination",attrs:{"current-page":e.resultForm.current,"page-sizes":[10,20,30,40],"page-size":e.resultForm.size,layout:" prev, pager, next, sizes,jumper,total",total:e.resultForm.total},on:{"size-change":e.resultSizeChange,"current-change":e.resultCurrentChange}})],1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["executeEntry"===e.type?a("el-button",{attrs:{type:"primary"},on:{click:e.entry}},[e._v("录入")]):e._e(),e.isNeedConfirm?a("el-button",{attrs:{type:"primary"},on:{click:e.comfirm}},[e._v("校验通过")]):e._e(),a("el-button",{on:{click:e.handleClose}},[e._v("关闭")])],1)]):e._e()],1)},l=[],i=(a("8e6e"),a("456d"),a("7f7f"),a("ac6a"),a("2909")),s=a("ade3"),o=a("c286");function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={components:{},mixins:[o["a"]],props:{visible:{type:Boolean,default:function(){return!1}},showData:{type:Object,default:function(){return{}}},type:{type:String,default:function(){return""}},isNeedConfirm:{type:Boolean,default:function(){return!1}},isSelect:{type:Boolean,default:function(){return!1}}},data:function(){return{isSupervision:!1,isEntry:!1,isPreview:!1,time:"",loading:!0,queryData:{},dialogRes:!1,dialogHeaderColor:"",resultForm:{targetSubjectField:"",recommendedSubjectField:"",targetSearchText:"",recommendSearchText:"",targetKey:"",recKey:"",targetKeyName:"",recKeyName:"",current:1,size:10,total:500},selectionData:[],columnData:[],headStyle:{background:"#189afb"},targetSubjectFieldOptions:[],recommendedSubjectFieldOptions:[],resultPreviewData:[],resultPreviewRes:!0,labelForm:{current:1,size:10,total:0},targetSubjectLabelOptions:[],recommendedSubjectLabelOptions:[],labelRelationData:[],labelRelationRes:!1}},watch:{type:function(){this.typeDeal()}},mounted:function(){this.typeDeal(),this.getTargetSubjectLabelOptions(),this.getRecommendedSubjectLabelOptions()},methods:{timeStyle:function(e){return e.columnIndex<this.columnData.filter((function(e){return e.differColor})).length?"background-color: #e3f7f3":"background-color: #fffaeb"},typeDeal:function(){console.log(this.type,"this.type"),"executeEntry"!==this.type&&"executeResultShow"!==this.type||(this.isEntry=!0),"executeSupervision"===this.type&&(this.isSupervision=!0),"preview"===this.type?(this.isPreview=!0,this.dataInitPreview()):(this.isPreview=!1,this.dataInitResult(),this.getLabelRelationData())},dataInitPreview:function(){var e=this,t=c(c({},this.showData),{},{current:this.resultForm.current,size:this.resultForm.size});this.queryData=c({},t),this.resultPreview({current:t.current,size:t.size,recId:t.recId,targetId:t.targetId,recTagId:t.listRelationPair[0].tagRecId,targetTagId:t.listRelationPair[0].tagTargetId}).then((function(t){e.resultForm.total=t.page.total,e.getTargetSubjectFieldOptions(t.showField[1]),e.getRecommendedSubjectFieldOptions(t.showField[0]),console.log(e.columnData,"dbcolumnName"),e.resultPreviewData=Object(i["a"])(t.result),e.loading=!1})).catch((function(t){t&&(e.loading=!1)}))},dataInitResult:function(){var e=this;console.log(this.showData,"this.showData");var t=c(c({},this.showData),{},{current:this.resultForm.current,size:this.resultForm.size});this.queryData=c({},t);var a={current:t.current,size:t.size,relationNumber:t.relationNumber,exeType:this.isEntry?t.exeType:"",version:this.time,callType:this.isSupervision?"2":"1"};this.resultCrate(a).then((function(t){e.resultForm.total=t.page.total,e.getTargetSubjectFieldOptions(t.showField[1]),e.getRecommendedSubjectFieldOptions(t.showField[0]),console.log(e.columnData,"dbcolumnName"),e.isEntry&&e.columnData.push({prop:"IS_REDER",label:"是否被读取",differColor:!1},{prop:"EXE_TIME",label:"执行时间",differColor:!1}),e.isSupervision&&e.columnData.push({prop:"REQUEST_NUM",label:"读取次数",differColor:!1},{prop:"USE_NUM",label:"来电次数",differColor:!1}),e.resultPreviewData=Object(i["a"])(t.result),e.loading=!1})).catch((function(t){t&&(e.loading=!1)}))},searchResultPreviewData:function(){this.isPreview?this.getPreviewData():this.getResultData()},handleSelectionChange:function(e){this.selectionData=e},searchLabelRelationData:function(){},resultSizeChange:function(e){this.resultForm.size=e,this.isPreview?this.getPreviewData():this.getResultData()},resultCurrentChange:function(e){this.resultForm.current=e,this.isPreview?this.getPreviewData():this.getResultData()},labelSizeChange:function(e){this.labelForm.size=e,this.getLabelRelationData()},labelCurrentChange:function(e){this.labelForm.current=e,this.getLabelRelationData()},entry:function(){var e=this,t=this.selectionData.map((function(t){return{targetValue:t[e.resultForm.targetKeyName],recValue:t[e.resultForm.recKeyName]}}));this.resultReadUpdate({previewRequestList:t}).then((function(t){e.$message.info(t)}))},comfirm:function(){var e=this;this.dialogRes=!1,this.updateCheckState({relationNumber:this.queryData.relationNumber,checkState:this.queryData.checkStateId}).then((function(t){e.$message.success("校验完成"),e.$emit("update:visible",!1)})).catch((function(t){t&&e.$emit("update:visible",!1)}))},handleClose:function(){this.dialogRes=!1,this.$emit("update:visible",!1)},getPreviewData:function(){var e=this;this.resultPreviewRes=!1,this.loading=!0,this.resultPreview({current:this.resultForm.current,size:this.resultForm.size,recId:this.queryData.recId,targetId:this.queryData.targetId,recTagId:this.queryData.listRelationPair[0].tagRecId,targetTagId:this.queryData.listRelationPair[0].tagTargetId,targetKey:this.resultForm.targetKey,recKey:this.resultForm.recKey,recValue:this.resultForm.recommendSearchText,targetValue:this.resultForm.targetSearchText}).then((function(t){console.log(t),e.resultForm.total=t.page.total,console.log(e.resultForm.targetSubjectField,"targetSubjectField"),console.log(e.resultForm.recommendedSubjectField,"recommendedSubjectField");var a=[];e.resultForm.targetSubjectField.forEach((function(t){a.push({prop:t,label:e.filterField(t),differColor:!0})})),e.resultForm.recommendedSubjectField.forEach((function(t){a.push({prop:t,label:e.filterField(t)})})),e.columnData=a,e.resultPreviewData=Object(i["a"])(t.result),e.loading=!1,e.resultPreviewRes=!0})).catch((function(t){t&&(e.loading=!1,e.resultPreviewRes=!0)}))},getResultData:function(){var e=this;this.resultPreviewRes=!1,this.loading=!0;var t={current:this.resultForm.current,size:this.resultForm.size,relationNumber:this.queryData.relationNumber,targetKey:this.resultForm.targetKey,recKey:this.resultForm.recKey,recValue:this.resultForm.recommendSearchText,targetValue:this.resultForm.targetSearchText,version:this.time,exeType:this.isEntry?this.queryData.exeType:"",callType:this.isSupervision?"2":"1"};this.resultCrate(t).then((function(t){e.resultForm.total=t.page.total,console.log(e.resultForm.targetSubjectField,"targetSubjectField"),console.log(e.resultForm.recommendedSubjectField,"recommendedSubjectField");var a=[];e.resultForm.targetSubjectField.forEach((function(t){a.push({prop:t,label:e.filterField(t),differColor:!0})})),e.resultForm.recommendedSubjectField.forEach((function(t){a.push({prop:t,label:e.filterField(t)})})),e.columnData=a,e.resultPreviewData=Object(i["a"])(t.result),e.loading=!1,e.resultPreviewRes=!0})).catch((function(t){t&&(e.loading=!1,e.resultPreviewRes=!0)}))},filterField:function(e){var t=[].concat(Object(i["a"])(this.targetSubjectFieldOptions),Object(i["a"])(this.recommendedSubjectFieldOptions)),a="";return t.forEach((function(t){t.value===e&&(a=t.name)})),a},getTargetSubjectFieldOptions:function(e){var t=this;this.targetSubjectFieldOptions=e.map((function(e){return e.isKey&&(t.resultForm.targetKey=e.dbcolumnName,t.resultForm.targetKeyName=e.dbcolumnAS),{name:e.dbcolumnTitle,value:e.dbcolumnAS}})),this.resultForm.targetSubjectField.push(this.resultForm.targetKeyName),this.columnData.push({prop:this.resultForm.targetKeyName,label:this.filterField(this.resultForm.targetKeyName),differColor:!0})},getRecommendedSubjectFieldOptions:function(e){var t=this;this.recommendedSubjectFieldOptions=e.map((function(e){return e.isKey&&(t.resultForm.recKey=e.dbcolumnName,t.resultForm.recKeyName=e.dbcolumnAS),{name:e.dbcolumnTitle,value:e.dbcolumnAS}})),this.resultForm.recommendedSubjectField.push(this.resultForm.recKeyName),this.columnData.push({prop:this.resultForm.recKeyName,label:this.filterField(this.resultForm.recKeyName),differColor:!1})},getTargetSubjectLabelOptions:function(){this.targetSubjectLabelOptions=[{name:"经常投诉客户",value:"001"},{name:"经常点赞客户",value:"002"}]},getRecommendedSubjectLabelOptions:function(){this.recommendedSubjectLabelOptions=[{name:"擅长处理投诉客户的坐席",value:"001"},{name:"不擅长处理投诉客户的坐席",value:"002"}]},getLabelRelationData:function(){var e=this;console.log(this.queryData,"this.queryData"),this.labelRelationRes=!1,this.recommendationCorrelation(c({tagId:this.queryData.tagId},this.labelForm)).then((function(t){e.labelForm.total=t.total,e.labelRelationData=Object(i["a"])(t.records),e.labelRelationRes=!0}))}}},d=u,m=(a("7452"),a("2877")),h=Object(m["a"])(d,r,l,!1,null,"1325edc2",null);t["default"]=h.exports},7452:function(e,t,a){"use strict";var r=a("e2b11"),l=a.n(r);l.a},e2b11:function(e,t,a){}}]);
//# sourceMappingURL=chunk-efc181e6.64b472ae.js.map