(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02eed42d"],{2909:function(t,e,a){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}function l(t){if(Array.isArray(t))return i(t)}function o(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function n(t,e){if(t){if("string"===typeof t)return i(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(t,e):void 0}}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return l(t)||o(t)||n(t)||r()}a.d(e,"a",(function(){return s}))},"9b3a":function(t,e,a){},a203:function(t,e,a){"use strict";var i=a("9b3a"),l=a.n(i);l.a},f44b:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"executionInformation"},[a("div",{staticClass:"header"},[a("el-input",{staticClass:"input",attrs:{size:"small",placeholder:"请输入营销活动内容关键词"},model:{value:t.queryForm.activityKeyword,callback:function(e){t.$set(t.queryForm,"activityKeyword","string"===typeof e?e.trim():e)},expression:"queryForm.activityKeyword"}}),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.getTableData}},[t._v("查询")])],1),a("div",{staticClass:"content"},[a("el-table",{staticClass:"content-table",attrs:{border:"",data:t.tableData,height:500,"row-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{label:"序号",align:"center",type:"index",width:"70"}}),a("el-table-column",{attrs:{prop:"activityName",label:"营销活动名称"}}),a("el-table-column",{attrs:{align:"center",label:"计划参与活动的客户清单"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"text",attrs:{type:"text"},on:{click:function(a){return t.clickCheck(e.row)}}},[t._v("查看")])]}}])}),a("el-table-column",{attrs:{prop:"executePlacePlan",label:"计划执行地点"}}),a("el-table-column",{attrs:{prop:"executeTimePlan",label:"计划执行时间"}}),a("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),a("el-table-column",{attrs:{align:"center",label:"参与活动客户清单录入"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"text",attrs:{type:"text"},on:{click:function(a){return t.clickEntry(e.row)}}},[t._v("录入已执行营销活动客户清单")])]}}])}),a("el-table-column",{attrs:{align:"center",width:"200",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"text",attrs:{type:"text"},on:{click:function(a){return t.clickClose(e.row)}}},[t._v("关闭任务")])]}}])})],1),a("div",{staticClass:"content-page"},[a("el-pagination",{attrs:{"current-page":this.queryForm.current,"page-sizes":[10,20,30,40],"page-size":this.queryForm.size,layout:"total, sizes, prev, pager, next, jumper",total:this.queryForm.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),a("el-dialog",{staticClass:"check-dialog",attrs:{title:"推荐清单查看",visible:t.checkDialogVisible,width:"80%","before-close":t.checkDialogClose,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.checkDialogVisible=e}}},[a("span",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"header-text"},[t._v(t._s("推荐清单查看"))])]),a("div",{staticClass:"query-group"},[a("div",{staticClass:"search"},[a("el-select",{staticClass:"select",attrs:{size:"small",clearable:"",placeholder:"请选择标签"},model:{value:t.checkDialogForm.tagId,callback:function(e){t.$set(t.checkDialogForm,"tagId",e)},expression:"checkDialogForm.tagId"}},t._l(t.labelOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("el-input",{staticClass:"input",attrs:{size:"small",placeholder:"请输入用户编号"},model:{value:t.checkDialogForm.yhbh,callback:function(e){t.$set(t.checkDialogForm,"yhbh","string"===typeof e?e.trim():e)},expression:"checkDialogForm.yhbh"}}),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.getCheckDialogData}},[t._v("查询")])],1)]),a("el-table",{staticClass:"dialog-table",attrs:{border:"",data:t.checkDialogData,height:400,"row-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{prop:"yhbh",label:"用户编号"}}),a("el-table-column",{attrs:{prop:"yhmc",label:"用电客户名称"}}),a("el-table-column",{attrs:{prop:"yddz",label:"用户地址"}})],1),a("div",{staticClass:"dialog-pagination"},[a("el-pagination",{attrs:{"current-page":this.checkDialogForm.current,"page-sizes":[10,20,30,40],"page-size":this.checkDialogForm.size,layout:"total, sizes, prev, pager, next, jumper",total:this.checkDialogForm.total},on:{"size-change":t.checkDialogSizeChange,"current-change":t.checkDialogCurrentChange}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.checkDialogClose}},[t._v("关闭")])],1)],1),a("el-dialog",{staticClass:"entry-dialog",attrs:{title:"参与活动客户标记",visible:t.entryDialogVisible,width:"80%","before-close":t.entryDialogClose,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.entryDialogVisible=e}}},[a("span",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"header-text"},[t._v(t._s("参与活动客户标记"))])]),a("div",{staticClass:"query-group"},[a("div",{staticClass:"search"},[a("el-input",{staticClass:"input",attrs:{size:"small",placeholder:"请输入用户编号"},model:{value:t.entryDialogForm.yhbh,callback:function(e){t.$set(t.entryDialogForm,"yhbh","string"===typeof e?e.trim():e)},expression:"entryDialogForm.yhbh"}}),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.getEntryDialogData}},[t._v("查询")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.downFile}},[t._v("下载模板")]),a("el-upload",{staticClass:"upload",attrs:{action:t.actionUrl,data:t.uploadParams,"on-success":t.handleSuccess,multiple:"",accept:".xls, .xlsx","before-upload":t.beforeUpload,"show-file-list":!1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("上传清单")])],1)],1)]),a("el-table",{staticClass:"dialog-table",attrs:{border:"",data:t.entryDialogData,height:400,"row-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{prop:"yhbh",label:"用户编号"}}),a("el-table-column",{attrs:{prop:"yhmc",label:"用电客户名称"}}),a("el-table-column",{attrs:{prop:"yddz",label:"用户地址"}}),a("el-table-column",{attrs:{prop:"algorithm",label:"是否算法推荐用户"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s("1"===e.row.algorithm?"是":"否")+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"czsj",align:"center",label:"是否参与活动"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-checkbox",{attrs:{disabled:e.row.flag},on:{change:function(a){return t.activeSelect(e.row)}},model:{value:e.row.flag,callback:function(a){t.$set(e.row,"flag",a)},expression:"scope.row.flag"}})]}}])}),a("el-table-column",{attrs:{prop:"operateTime",label:"操作时间"}})],1),a("div",{staticClass:"dialog-pagination"},[a("el-pagination",{attrs:{"current-page":t.entryDialogForm.current,"page-sizes":[5,20,30,40],"page-size":t.entryDialogForm.size,layout:"total, sizes, prev, pager, next, jumper",total:t.entryDialogForm.total},on:{"size-change":t.entryDialogSizeChange,"current-change":t.entryDialogCurrentChange}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.entryDialogClose}},[t._v("关闭")])],1)],1)],1)},l=[],o=(a("8e6e"),a("456d"),a("ade3")),n=a("2909"),r=(a("ac6a"),a("7f7f"),a("db49")),s=a("6ed3"),c=a("4328"),u=a.n(c);function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var p={name:"executionInformation",components:{},mixins:[s["a"]],props:{},data:function(){return{queryForm:{status:"3",activityKeyword:"",current:1,size:10,total:0},activityId:"",tableData:[],checkDialogVisible:!1,checkDialogData:[{}],checkDialogForm:{tagId:"",yhbh:"",current:1,size:10,total:0},labelOptions:[],entryDialogVisible:!1,entryDialogData:[],entryDialogForm:{yhbh:"",current:1,size:5,total:0},uploadParams:{current:1,size:5,activityId:"",fileUploadId:""},actionUrl:r["c"]+"/cptActivityConfig/uploadExcel",tableType:"1"}},mounted:function(){this.getTableData()},methods:{tableRowClassName:function(t){t.row;var e=t.rowIndex;return e%2===0?"success-row":""},handleSizeChange:function(t){this.queryForm.size=t,this.getTableData()},handleCurrentChange:function(t){this.queryForm.current=t,this.getTableData()},clickEntry:function(t){this.activityId=t.activityId,window.console.log(t,";;"),this.getEntryDialogData(),this.entryDialogVisible=!0},clickCheck:function(t){this.activityId=t.activityId,this.checkDialogForm.current=1,this.checkDialogForm.size=10,this.getLabelOptions(),this.getCheckDialogData(),this.checkDialogVisible=!0},checkDialogClose:function(){this.checkDialogVisible=!1},checkDialogSizeChange:function(t){this.checkDialogForm.size=t,this.getCheckDialogData()},checkDialogCurrentChange:function(t){this.checkDialogForm.current=t,this.getCheckDialogData()},downFile:function(){window.location.href=r["c"]+"/cptActivityConfig/downloadTemplate"},beforeUpload:function(t,e){this.uploadParams.activityId=this.activityId,this.uploadParams.current=this.entryDialogForm.current=1,this.uploadParams.size=this.entryDialogForm.size;var a=t.name.substring(t.name.lastIndexOf(".")+1),i="xls"===a||"xlsx"===a;return i||this.$alert("上传文件只能是xls、xlsx格式!"),i},handleSuccess:function(t,e){this.uploadParams.fileUploadId=t.data.fileUploadId||"",console.log(e),"00000"===t.code&&(this.tableType="2",this.$message.success("上传成功"),t.data.rows.forEach((function(t){t.flag="1"===t.flag})),this.entryDialogData=Object(n["a"])(t.data.rows),this.entryDialogForm.total=t.data.total,this.entryDialogData.forEach((function(t){t.bindTagB="1"===t.bindTag})))},UploadExcel:function(){var t=this;this.uploadExcel(u.a.stringify({current:this.entryDialogForm.current,size:this.entryDialogForm.size,activityId:this.uploadParams.activityId,fileUploadId:this.uploadParams.fileUploadId})).then((function(e){t.tableType="2",e.rows.forEach((function(t){t.flag="1"===t.flag})),t.entryDialogData=Object(n["a"])(e.rows),t.entryDialogForm.total=e.total,t.entryDialogData.forEach((function(t){t.bindTagB="1"===t.bindTag}))}))},entryDialogClose:function(){this.entryDialogVisible=!1},entryDialogSizeChange:function(t){this.entryDialogForm.size=t,"1"===this.tableType?this.getEntryDialogData():this.UploadExcel()},entryDialogCurrentChange:function(t){this.entryDialogForm.current=t,"1"===this.tableType?this.getEntryDialogData():this.UploadExcel()},clickClose:function(t){var e=this;this.$confirm("此操作将关闭改任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.console.log(t),e.closeTask({id:t.id}).then((function(){e.getTableData(),e.$message.info("已关闭")}))})).catch((function(){}))},getTableData:function(){var t=this;this.getActivityConfig(this.queryForm).then((function(e){t.tableData=Object(n["a"])(e.records),t.queryForm.total=e.total}))},getCheckDialogData:function(){var t=this;this.getRecommendCustomer(g(g({},this.checkDialogForm),{},{activityId:this.activityId})).then((function(e){t.checkDialogData=Object(n["a"])(e.records),t.checkDialogForm.total=e.total}))},getEntryDialogData:function(){var t=this;this.customerList({size:this.entryDialogForm.size,current:this.entryDialogForm.current,activityId:this.activityId,yhbh:this.entryDialogForm.yhbh}).then((function(e){t.tableType="1",e.records.forEach((function(t){t.flag="1"===t.flag})),t.entryDialogData=e.records,window.console.log(t.entryDialogData),t.entryDialogForm.total=e.total}))},getLabelOptions:function(){var t=this;this.getLabel({tagobjId:r["i"]}).then((function(e){0!==e.length&&(t.labelOptions=e.map((function(t){return{value:t.bqId,label:t.bqName}})))}))},activeSelect:function(t){var e=this;this.$confirm("勾选后将不可逆, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.joinActivity({activityId:e.activityId,yhbh:t.yhbh}).then((function(){e.$message.success("勾选参与活动成功")}))})).catch((function(){t.flag=!1,e.$message({type:"info",message:"已取消标记"})}))}}},d=p,y=(a("a203"),a("2877")),b=Object(y["a"])(d,i,l,!1,null,"26005f15",null);e["default"]=b.exports}}]);
//# sourceMappingURL=chunk-02eed42d.76edd5c3.js.map